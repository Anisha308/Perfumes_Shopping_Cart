<%- include('../layouts/userHeader.ejs') %>
<style>
.add-padding{
  padding-top: 150px;
  
}

body{
    margin-top:20px;
    background:#eee;
    font-size: 15px;
}
/* My Account */
.payments-item img.mr-3 {
    width: 47px;
}
.order-list .btn {
    border-radius: 2px;
    min-width: 121px;
    font-size: 10px;
    padding: 7px 0 7px 0;
}
.osahan-account-page-left .nav-link {
    padding: 18px 20px;
    border: none;
    font-weight: 600;
    color: #535665;
}
.osahan-account-page-left .nav-link i {
    width: 28px;
    height: 28px;
    background: #535665;
    display: inline-block;
    text-align: center;
    line-height: 29px;
    font-size: 15px;
    border-radius: 50px;
    margin: 0 7px 0 0px;
    color: #fff;
}
.osahan-account-page-left .nav-link.active {
    background: #f3f7f8;
    color: #282c3f !important;
}
.osahan-account-page-left .nav-link.active i {
    background: #282c3f !important;
}
.osahan-user-media img {
    width: 90px;
}
.card offer-card h5.card-title {
    border: 2px dotted #000;
}
.card.offer-card h5 {
    border: 1px dotted #daceb7;
    display: inline-table;
    color: #17a2b8;
    margin: 0 0 19px 0;
    font-size: 15px;
    padding: 6px 10px 6px 6px;
    border-radius: 2px;
    background: #fffae6;
    position: relative;
}
.card.offer-card h5 img {
    height: 22px;
    object-fit: cover;
    width: 22px;
    margin: 0 8px 0 0;
    border-radius: 2px;
}
.card.offer-card h5:after {
    border-left: 4px solid transparent;
    border-right: 4px solid transparent;
    border-bottom: 4px solid #daceb7;
    content: "";
    left: 30px;
    position: absolute;
    bottom: 0;
}
.card.offer-card h5:before {
    border-left: 4px solid transparent;
    border-right: 4px solid transparent;
    border-top: 4px solid #daceb7;
    content: "";
    left: 30px;
    position: absolute;
    top: 0;
}
.payments-item .media {
    align-items: center;
}
.payments-item .media img {
    margin: 0 40px 0 11px !important;
}
.reviews-members .media .mr-3 {
    width: 56px;
    height: 56px;
    object-fit: cover;
}
.order-list img.mr-4 {
    width: 70px;
    height: 70px;
    object-fit: cover;
    box-shadow: 0 .125rem .25rem rgba(0, 0, 0, .075)!important;
    border-radius: 2px;
}
.osahan-cart-item p.text-gray.float-right {
    margin: 3px 0 0 0;
    font-size: 10px;
}
.osahan-cart-item .food-item {
    vertical-align: bottom;
}

.h1, .h2, .h3, .h4, .h5, .h6, h1, h2, h3, h4, h5, h6 {
    color: #000000;
}

.shadow-sm {
    box-shadow: 0 .125rem .25rem rgba(0,0,0,.075)!important;
}

.address {
  padding-top: 180px;
}
</style>



<link rel="stylesheet" href="https://allyoucan.cloud/cdn/icofont/1.0.1/icofont.css" integrity="sha384-jbCTJB16Q17718YM9U22iJkhuGbS0Gd2LjaWb4YJEZToOPmnKDjySVa323U+W7Fv" crossorigin="anonymous">

<div class="container">
    <div class="row address">
        <div class="col-md-3">
            <div class="osahan-account-page-left shadow-sm bg-white h-100">
                <div class="border-bottom p-4">
                    <div class="osahan-user text-center">
                        <div class="osahan-user-media">
                            <img class="mb-3 rounded-pill shadow-sm mt-1" src="images/icons/user.png" alt="gurdeep singh osahan">
                            <div class="osahan-user-media-body">
                                <h6 class="mb-2"><%= user.username %></h6>
                                <p class="mb-1"><%= user.email %></p>
                                <p><%= user.mobile %></p>
</p>
                                <!-- <p class="mb-0 text-black font-weight-bold"><a class="text-primary mr-3" data-toggle="modal" data-target="#edit-profile-modal" href="#"><i class="icofont-ui-edit"></i> EDIT</a></p> -->
                            </div>
                        </div>
                    </div>
                </div>
                <ul class="nav nav-tabs flex-column border-0 pt-4 pl-4 pb-4" id="myTab" role="tablist">
                    <li class="nav-item">
                           <button
        class="btn btn-dark"
        data-toggle="modal"
        data-target="#exampleModal"
      >
        Add address
      </button>
                   <p style="margin-top: 20px;">
  <a href="/profile" style="color: black; text-decoration: none; display: inline-block;">
    <strong style="font-size: 20px; margin-right: 5px;">&#8592;</strong> 
    <span style="font-size: 18px;">Go Back</span>
  </a>
</p>

      <div>
                      </li>
                </ul>
            </div>
        </div>
        <div class="col-md-9">
            <div class="osahan-account-page-right shadow-sm bg-white p-4 h-100">
                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade  active show" id="addresses" role="tabpanel" aria-labelledby="addresses-tab">
                        <h4 class="font-weight-bold mt-0 mb-4">Manage Addresses</h4>
                        
                        <div class="row">
                           <% addressItem.forEach((deliveryItem) => { %> <%
            deliveryItem.deliveryAddress.forEach((address) => { %>
                            <div class="col-md-6">
                                <div class="bg-white card addresses-item mb-4 border border-primary shadow">
                                    <div class="gold-members p-4">
                                        <div class="media">
                                            <div class="mr-3"><i class="icofont-ui-home icofont-3x"></i></div>
                                            <div class="media-body">
                                                <h6 class="mb-1 text-secondary"><%= address.name %></h6>
                                                <p><%= address.mobile ? address.mobile : "" %> <%= address.email ? "(" + address.email + ")" : "" %></p>
                                                <p class="text-black"> <%= address.address %> <%= address.district %> <%= address.state %> <%= address.pincode %></p>
                                                <p class="mb-0 text-black font-weight-bold">
                                                  <a class="text-primary mr-3" data-toggle="modal" data-target="#editModal<%= address._id %>" href="#"><i class="icofont-ui-edit"></i> EDIT</a>
                                                   <a class="text-danger" data-toggle="modal"  data-target="#deleteModal<%= address._id %>"
  onclick="showConfirmation('<%= address._id %>')"
> <i class="icofont-ui-delete"></i> DELETE</a></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>

                            <div class="modal fade" id="editModal<%= address._id %>" tabindex="-1" role="dialog" aria-labelledby="editModalLabel<%= address._id %>" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" id="editModalLabel<%= address._id %>">Edit Address</h4>
        </div>
        <div class="modal-body">
          <form action="/edit-address?id=<%= address._id %>" method="POST">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="editName">Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="editName"
                  name="editName"
                  value="<%= address.name %>"
                 
                />
                <div class="invalid-feedback">
                  Please provide a valid name.
                </div>
              </div>
              <div class="col-md-6 mb-3">
                <label for="editMobile">Mobile</label>
                <input
                  type="text"
                  class="form-control"
                  id="editMobile"
                  name="mobile"
                  value="<%= address.mobile %>"
                  
                />
                <div class="invalid-feedback">
                  Please provide a valid mobile number.
                </div>
              </div>
            </div>

            <!-- Similar fields for email, address, pincode, district, state, country -->
<div class="mb-3">
                  <label for="email"
                    >Email <span class="text-muted">(Optional)</span></label
                  >
                 <input
  type="email"
  class="form-control"
  name="email"
  value="<%= address.email %>"
/>

                  <div class="invalid-feedback">
                    Please enter a valid email address for shipping updates.
                  </div>
                </div>

                <div class="mb-3">
                  <label for="address">Address</label>
                  <input
                    type="text"
                    class="form-control"
                    name="address"

                    
                    

                    value="<%= address.address %>"
                  />
                  <div class="invalid-feedback">
                    Please enter your shipping address.
                  </div>
                </div>
                <div class="row">
                  <div class="mb-3 col">
                    <label for="pincode"
                      >Pincode<span class="text-muted"></span
                    ></label>
                    <input
                      type="text"
                      class="form-control"
                      name="pincode"
                      value="<%= address.pincode %>"
                    />
                  </div>
                  <div class="mb-3 col">
                    <label for="district"
                      >District<span class="text-muted"></span
                    ></label>
                    <input
                      type="text"
                      class="form-control"
                      name="district"

                      value="<%= address.district %>"
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col mb-3">
                    <label for="state">State</label>
                    <select
                      class="custom-select d-block w-100"
                      name="state"
                       
                    >
                      <option value="<%= address.state %>"><%= address.state %></option>
                          <option value="Andhra Pradesh">Andhra Pradesh</option>
    <option>Arunachal Pradesh</option>
    <option>Assam</option>
    <option>Bihar</option>
    <option>Chhattisgarh</option>
    <option>Goa</option>
    <option>Gujarat</option>
    <option>Haryana</option>
    <option>Himachal Pradesh</option>
    <option>Karnataka</option>
    <option>Jharkhand</option>
    <option>Madhya Pradesh</option>
    <option>Kerala</option>
    <option>Maharashtra</option>
    
    <option>Meghalaya</option>
    <option>Punjab</option>
    <option>Mizoram</option>
    <option>Nagaland</option>
    <option>Odisha</option>
    <option></option>
    <option>Tripura</option>
    <option>Rajasthan</option>
    <option>Tamil Nadu</option>
    <option>West Bengal</option>
    <option>Telangana</option>
    <option>Uttar Pradesh</option>
    <option>Uttarakhand</option>>
                    </select>
                  </div>
                  <div class="col mb-3">
                    <label for="country">Country</label>
                    <select
                      class="custom-select d-block w-100"
                      name="country"
                     

                    >
                      <option value="India">India</option>
                      
                    </select>
                  </div>
                </div>
              </div>
          
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <% }) %> <% }) %>
  </div>


              
      

                            
                       
                        

<!-- <div class="container">
  <div class="row add-padding">
    <div class="col-md-6 mb-4">
      <div class="mt-5">
        <h4 class="mb-3">Saved Address</h4>
        <ul class="list-group mb-3">
          <% addressItem.forEach((deliveryItem) => { %> <%
            deliveryItem.deliveryAddress.forEach((address) => { %>
        

                  <!-- Edit Address Modal -->
  <div class="modal fade" id="editModal<%= address._id %>" tabindex="-1" role="dialog" aria-labelledby="editModalLabel<%= address._id %>" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" id="editModalLabel<%= address._id %>">Edit Address</h4>
        </div>
        <div class="modal-body">
          <form action="/edit-address?id=<%= address._id %>" method="POST">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="editName">Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="editName"
                  name="editName"
                  value="<%= address.name %>"
                 
                />
                <div class="invalid-feedback">
                  Please provide a valid name.
                </div>
              </div>
              <div class="col-md-6 mb-3">
                <label for="editMobile">Mobile</label>
                <input
                  type="text"
                  class="form-control"
                  id="editMobile"
                  name="mobile"
                  value="<%= address.mobile %>"
                  
                />
                <div class="invalid-feedback">
                  Please provide a valid mobile number.
                </div>
              </div>
            </div>

            <!-- Similar fields for email, address, pincode, district, state, country -->
<div class="mb-3">
                  <label for="email"
                    >Email <span class="text-muted">(Optional)</span></label
                  >
                 <input
  type="email"
  class="form-control"
  name="email"
  value="<%= address.email %>"
/>

                  <div class="invalid-feedback">
                    Please enter a valid email address for shipping updates.
                  </div>
                </div>

                <div class="mb-3">
                  <label for="address">Address</label>
                  <input
                    type="text"
                    class="form-control"
                    name="address"

                    
                    

                    value="<%= address.address %>"
                  />
                  <div class="invalid-feedback">
                    Please enter your shipping address.
                  </div>
                </div>
                <div class="row">
                  <div class="mb-3 col">
                    <label for="pincode"
                      >Pincode<span class="text-muted"></span
                    ></label>
                    <input
                      type="text"
                      class="form-control"
                      name="pincode"
                      value="<%= address.pincode %>"
                    />
                  </div>
                  <div class="mb-3 col">
                    <label for="district"
                      >District<span class="text-muted"></span
                    ></label>
                    <input
                      type="text"
                      class="form-control"
                      name="district"

                      value="<%= address.district %>"
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col mb-3">
                    <label for="state">State</label>
                    <select
                      class="custom-select d-block w-100"
                      name="state"
                       
                    >
                      <option value="<%= address.state %>"><%= address.state %></option>
                          <option value="Andhra Pradesh">Andhra Pradesh</option>
    <option>Arunachal Pradesh</option>
    <option>Assam</option>
    <option>Bihar</option>
    <option>Chhattisgarh</option>
    <option>Goa</option>
    <option>Gujarat</option>
    <option>Haryana</option>
    <option>Himachal Pradesh</option>
    <option>Karnataka</option>
    <option>Jharkhand</option>
    <option>Madhya Pradesh</option>
    <option>Kerala</option>
    <option>Maharashtra</option>
    
    <option>Meghalaya</option>
    <option>Punjab</option>
    <option>Mizoram</option>
    <option>Nagaland</option>
    <option>Odisha</option>
    <option></option>
    <option>Tripura</option>
    <option>Rajasthan</option>
    <option>Tamil Nadu</option>
    <option>West Bengal</option>
    <option>Telangana</option>
    <option>Uttar Pradesh</option>
    <option>Uttarakhand</option>>
                    </select>
                  </div>
                  <div class="col mb-3">
                    <label for="country">Country</label>
                    <select
                      class="custom-select d-block w-100"
                      name="country"
                     

                    >
                      <option value="India">India</option>
                      
                    </select>
                  </div>
                </div>
              </div>
          
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

<% }) %> <% }) %>
              
        </ul>
        
      </div>
    </div>

  
      

    <div class="container">


      <div>
     
       <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="deleteModalLabel">Confirm Deletion</h4>
      </div>
      <div class="modal-body">
        Are you sure you want to delete this address?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button id="deleteConfirmButton" type="button" class="btn btn-danger">Delete</button>
      </div>
    </div>
  </div>
</div>
      
      </div>
  

      <!-- The Modal -->
      <form action="/addProfileaddress" method="POST">
        <div
          class="modal fade"
          id="exampleModal"
          tabindex="-1"
          role="dialog"
          aria-labelledby="exampleModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h4 class="mb-3">Your address</h4>
              </div>
              <div class="modal-body">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="name">Name</label>
                    <input
                      type="text"
                      class="form-control"
                      id="name"
                      name="name"
                      placeholder=""
                      value=""
                    
                      
                    />
                    <div class="invalid-feedback">
                      Please provide a valid name.
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="mobile">Mobile</label>
                    <input
                      type="text"
                      class="form-control"
                      id="mobile"
                      name="mobile"
                      placeholder=""
                      value=""
                     
                    />
                    <div class="invalid-feedback">
                      Please provide a valid mobile number.
                    </div>
                  </div>
                </div>

                <div class="mb-3">
                  <label for="email"
                    >Email <span class="text-muted">(Optional)</span></label
                  >
                  <input
                    type="email"
                    class="form-control"
                    name="email"
                    placeholder="you@example.com"
                  />
                  <div class="invalid-feedback">
                    Please enter a valid email address for shipping updates.
                  </div>
                </div>

                <div class="mb-3">
                  <label for="address">Address</label>
                  <input
                    type="text"
                    class="form-control"
                    name="address"
                    placeholder="1234 Main St"
                   
                    
                  />
                  <div class="invalid-feedback">
                    Please enter your shipping address.
                  </div>
                </div>
                <div class="row">
                  <div class="mb-3 col">
                    <label for="pincode"
                      >Pincode<span class="text-muted"></span
                    ></label>
                    <input
                      type="text"
                      class="form-control"
                      name="pincode"
                      placeholder="Apartment or suite"
                    />
                  </div>
                  <div class="mb-3 col">
                    <label for="district"
                      >District<span class="text-muted"></span
                    ></label>
                    <input
                      type="text"
                      class="form-control"
                      name="district"
                      placeholder="Apartment or suite"
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col mb-3">
                    <label for="state">State</label>
                    <select
                      class="custom-select d-block w-100"
                      name="state"
                     
                    >
                      <option value="">Choose...</option>
                          <option value="Andhra Pradesh">Andhra Pradesh</option>
    <option>Arunachal Pradesh</option>
    <option>Assam</option>
    <option>Bihar</option>
    <option>Chhattisgarh</option>
    <option>Goa</option>
    <option>Gujarat</option>
    <option>Haryana</option>
    <option>Himachal Pradesh</option>
    <option>Karnataka</option>
    <option>Jharkhand</option>
    <option>Madhya Pradesh</option>
    <option>Kerala</option>
    <option>Maharashtra</option>
    
    <option>Meghalaya</option>
    <option>Punjab</option>
    <option>Mizoram</option>
    <option>Nagaland</option>
    <option>Odisha</option>
    <option></option>
    <option>Tripura</option>
    <option>Rajasthan</option>
    <option>Tamil Nadu</option>
    <option>West Bengal</option>
    <option>Telangana</option>
    <option>Uttar Pradesh</option>
    <option>Uttarakhand</option>
                    </select>
                  </div>
                  <div class="col mb-3">
                    <label for="country">Country</label>
                    <select
                      class="custom-select d-block w-100"
                      name="country"
                    
                    >
                      <option>India</option>
                      
                    </select>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-dismiss="modal"
                >
                  Close
                </button>
                <button type="submit" class="btn btn-primary">
                  Save changes
                </button>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  
    function showConfirmation(addressId) {
      console.log(addressId,'addressId');
        Swal.fire({
            title: 'Are you sure?',
            text: 'You are about to delete this address',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'Cancel',
        }).then((result) => {
            if (result.isConfirmed) {
              console.log("hoo")
                deleteItem(addressId);
            }
        });
    }

    function deleteItem(addressId) {
console.log(typeof addressId,'kkkkkkkkkkkkkkkkkkk');
        $.ajax({
            url: `/deletes/${addressId}`,
            method: 'POST',
            data: {
                addressId: addressId,
            },
            
            success: function (response) {
                // Handle the success response (optional)
                console.log(response);
                Swal.fire({
                    icon: 'success',
                    title: 'Address deleted successfully!',
                    showConfirmButton: false,
                    timer: 1500,
                }).then(() => {
                    // After the success message, reload the page or perform any other action
                    location.reload();
                });
            },
            error: function (error) {
                // Handle the error response (optional)
                Swal.fire({
                    icon: 'error',
                    title: 'Failed to delete Address. Please try again.',
                    showConfirmButton: false,
                    timer: 1500,
                });
            },
        });
    }
</script>
